{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to YDrip Documentation YDrip is an open-source water meter designed to help you monitor and conserve water usage. What is YDrip? YDrip is a hardware device that uses a magnetoresistive sensor to monitor the flow of water through your existing water meter. It detects rotations of the water meter\u2019s internal magnet Hardware Versions YDrip is continuously evolving, with new hardware versions adding features and improving performance. The current hardware version is: Version 0.4 Features an IP68-rated enclosure for outdoor installations. Powered by an ESP32-S3 microcontroller. Includes the ALT021-10E magnetoresistive sensor. Designed for Home Assistant integration with customizable settings. Resources YDrip GitHub Repository Firmware Releases","title":"Home"},{"location":"#welcome-to-ydrip-documentation","text":"YDrip is an open-source water meter designed to help you monitor and conserve water usage.","title":"Welcome to YDrip Documentation"},{"location":"#what-is-ydrip","text":"YDrip is a hardware device that uses a magnetoresistive sensor to monitor the flow of water through your existing water meter. It detects rotations of the water meter\u2019s internal magnet","title":"What is YDrip?"},{"location":"#hardware-versions","text":"YDrip is continuously evolving, with new hardware versions adding features and improving performance. The current hardware version is:","title":"Hardware Versions"},{"location":"#version-04","text":"Features an IP68-rated enclosure for outdoor installations. Powered by an ESP32-S3 microcontroller. Includes the ALT021-10E magnetoresistive sensor. Designed for Home Assistant integration with customizable settings.","title":"Version 0.4"},{"location":"#resources","text":"YDrip GitHub Repository Firmware Releases","title":"Resources"},{"location":"release-notes/","text":"Release Notes Hardware Releases For detailed information about hardware updates and to download PCB design files, visit the hardware releases on GitHub: Hardware Releases Software Releases For the latest firmware and ESPHome configurations, visit the software releases on GitHub: Software Releases","title":"Release Notes"},{"location":"release-notes/#release-notes","text":"","title":"Release Notes"},{"location":"release-notes/#hardware-releases","text":"For detailed information about hardware updates and to download PCB design files, visit the hardware releases on GitHub: Hardware Releases","title":"Hardware Releases"},{"location":"release-notes/#software-releases","text":"For the latest firmware and ESPHome configurations, visit the software releases on GitHub: Software Releases","title":"Software Releases"},{"location":"v0.4/","text":"Overview Hardware version 0.4 features an IP68 water resistant enclosure for outdoor use. The electronics feature an ESP32-S3 and the ALT021-10E magnetoresistive sensor. Precautions YDrip is stil in Beta and testing is ongoing. The following precautions should be followed to ensure reliability. If you find problems 1. Battery Orientation YDrip does not include reverse polarity protection. Inserting batteries incorrectly can permanently damage the internal electronics so be careful. 2. Water Submersion It is not recommended to submerge the device for long periods of time. The enclosure is rated IP68 , meaning it can resist water ingress for short periods (up to 1 meter depth for 30 minutes). However, there have been no long term tests for installations like a pit that regularly fill with water, especially under temperature change. Do so at your own risk. 3. Magnetic Interference Avoid installation near power lines or other magnetic field sources. YDrip\u2019s sensor is highly sensitive to magnetic fields. Strong magnets can permanently disrupt the sensor, leading to inaccurate readings. Magnetic fields may also interfere with readings. 4. Extreme Temperatures The components selected for YDrip are rated for industrial temperature ranges, however there has been no long term testing done. You may notice issues with battery life, gasket failure or calibration issues. Please report them on Github . Consider using Energizer Ultimate Lithium batteries for better temperature performance. Hardware Setup 3 AA batteries are required to power the device. Any 1.5v alkaline or rechargeable NiMH batteries work fine. Use Energizer Ultimate Lithium batteries if you are installing the device outdoors in extreme weather conditions. LED Color Code Legend Yellow : Uncalibrated, waiting for calibration. Flashing Red : Calibration failed. Blue : Calibration running. Green : Device is calibrated. No LED : The device is sleeping and measuring water usage. Connecting to Wi-Fi Insert a micro USB cable into the device. Note, it does not receive power over USB. Using Chrome, open the ESPHome Webtool . Click connect and select the serial port of the device. Then click the 'more' icon and select 'Configure Wi-Fi'. Follow the instructions from there. Installation Install YDrip around your water meter housing using the reusable zip-ties. The bottom of the case should line up with the top of the brass housing and should be as close as possible. See the picture at the top of this section. The PCB should be oriented so the side with the two buttons are facing the brass housing. Calibrating the Device At this point the yellow light should on indicating it has not been calibrated. To calibrate: Turn on a faucet at full power. Press the (awkwardly placed) User button on the device. The LED will: Blink blue for about a minute during calibration. Turn green once calibration is complete. If the LED blinks red , calibration failed. Repeat the calibration with the logs open using the ESPHome Webtool. Adding to Home Assistant Once your YDrip device is calibrated and configured, integrate it with Home Assistant to monitor water usage: In Home Assistant, go to Settings > Devices & Services . Click Add Integration and search for ESPHome . Add your YDrip device by entering its IP address. Confirm the device appears in your Home Assistant dashboard. The ESPHome integration exposes three sensors: Water usage in cubic meters Leak detection Battery percentage (A rudimentary conversion of battery voltage to capacity) Modifying Settings You will need to install the ESPHome Add-on in Home Assistant to upload a new YAML. You can also recompile using the command line and upload via serial as well. Installing the ESPHome Add-on Open your Home Assistant dashboard. Navigate to Settings > Add-ons > Add-on . Search for and install the ESPHome add-on. Note: Only certain versions of Home Assistant support add-ons. Ensure your Home Assistant instance supports them. Using a VM for Home Assistant OS is probably the simplest method. YAML Settings A sample YAML file for YDrip can be found on Github . The following section configures usage and leak alert wake up times ############### Water meter config #################### sensor: - platform: ydrip id: ydrip_sensor usage_alert_count: 1024 leak_alert_count: 32 low_freq_leak_thresh: 0.125 usage: name: \"Water Usage\" leak: name: \"Leak Detection\" battery_level: name: \"Battery Level\" usage_alert_count: Number of magnet rotations to wake up the ESP and report water usage. Should be a power of 2. leak_alert_count: Number of magnet rotations below low_freq_leak_thresh to wake up the ESP and report a leake. Should be a power of 2. low_freq_leak_thresh: Magnetic rotation frequency cutoff Hz. You should also change your fallback hotspot SSID and password. # Enable fallback hotspot (captive portal) in case wifi connection fails ap: ssid: \"Home Fallback Hotspot\" password: \"\" Flashing New Releases To keep your YDrip device updated: Download the latest firmware from the YDrip GitHub releases page . Use the ESPHome Webtool or the Home Assistant ESPHome add-on to flash the firmware to your device. Enjoy using YDrip to monitor your water usage and conserve resources. If you encounter any issues, visit the GitHub Issues page for support.","title":"Overview"},{"location":"v0.4/#overview","text":"Hardware version 0.4 features an IP68 water resistant enclosure for outdoor use. The electronics feature an ESP32-S3 and the ALT021-10E magnetoresistive sensor.","title":"Overview"},{"location":"v0.4/#precautions","text":"YDrip is stil in Beta and testing is ongoing. The following precautions should be followed to ensure reliability. If you find problems","title":"Precautions"},{"location":"v0.4/#1-battery-orientation","text":"YDrip does not include reverse polarity protection. Inserting batteries incorrectly can permanently damage the internal electronics so be careful.","title":"1. Battery Orientation"},{"location":"v0.4/#2-water-submersion","text":"It is not recommended to submerge the device for long periods of time. The enclosure is rated IP68 , meaning it can resist water ingress for short periods (up to 1 meter depth for 30 minutes). However, there have been no long term tests for installations like a pit that regularly fill with water, especially under temperature change. Do so at your own risk.","title":"2. Water Submersion"},{"location":"v0.4/#3-magnetic-interference","text":"Avoid installation near power lines or other magnetic field sources. YDrip\u2019s sensor is highly sensitive to magnetic fields. Strong magnets can permanently disrupt the sensor, leading to inaccurate readings. Magnetic fields may also interfere with readings.","title":"3. Magnetic Interference"},{"location":"v0.4/#4-extreme-temperatures","text":"The components selected for YDrip are rated for industrial temperature ranges, however there has been no long term testing done. You may notice issues with battery life, gasket failure or calibration issues. Please report them on Github . Consider using Energizer Ultimate Lithium batteries for better temperature performance.","title":"4. Extreme Temperatures"},{"location":"v0.4/#hardware-setup","text":"3 AA batteries are required to power the device. Any 1.5v alkaline or rechargeable NiMH batteries work fine. Use Energizer Ultimate Lithium batteries if you are installing the device outdoors in extreme weather conditions. LED Color Code Legend Yellow : Uncalibrated, waiting for calibration. Flashing Red : Calibration failed. Blue : Calibration running. Green : Device is calibrated. No LED : The device is sleeping and measuring water usage.","title":"Hardware Setup"},{"location":"v0.4/#connecting-to-wi-fi","text":"Insert a micro USB cable into the device. Note, it does not receive power over USB. Using Chrome, open the ESPHome Webtool . Click connect and select the serial port of the device. Then click the 'more' icon and select 'Configure Wi-Fi'. Follow the instructions from there.","title":"Connecting to Wi-Fi"},{"location":"v0.4/#installation","text":"Install YDrip around your water meter housing using the reusable zip-ties. The bottom of the case should line up with the top of the brass housing and should be as close as possible. See the picture at the top of this section. The PCB should be oriented so the side with the two buttons are facing the brass housing.","title":"Installation"},{"location":"v0.4/#calibrating-the-device","text":"At this point the yellow light should on indicating it has not been calibrated. To calibrate: Turn on a faucet at full power. Press the (awkwardly placed) User button on the device. The LED will: Blink blue for about a minute during calibration. Turn green once calibration is complete. If the LED blinks red , calibration failed. Repeat the calibration with the logs open using the ESPHome Webtool.","title":"Calibrating the Device"},{"location":"v0.4/#adding-to-home-assistant","text":"Once your YDrip device is calibrated and configured, integrate it with Home Assistant to monitor water usage: In Home Assistant, go to Settings > Devices & Services . Click Add Integration and search for ESPHome . Add your YDrip device by entering its IP address. Confirm the device appears in your Home Assistant dashboard. The ESPHome integration exposes three sensors: Water usage in cubic meters Leak detection Battery percentage (A rudimentary conversion of battery voltage to capacity)","title":"Adding to Home Assistant"},{"location":"v0.4/#modifying-settings","text":"You will need to install the ESPHome Add-on in Home Assistant to upload a new YAML. You can also recompile using the command line and upload via serial as well.","title":"Modifying Settings"},{"location":"v0.4/#installing-the-esphome-add-on","text":"Open your Home Assistant dashboard. Navigate to Settings > Add-ons > Add-on . Search for and install the ESPHome add-on. Note: Only certain versions of Home Assistant support add-ons. Ensure your Home Assistant instance supports them. Using a VM for Home Assistant OS is probably the simplest method.","title":"Installing the ESPHome Add-on"},{"location":"v0.4/#yaml-settings","text":"A sample YAML file for YDrip can be found on Github . The following section configures usage and leak alert wake up times ############### Water meter config #################### sensor: - platform: ydrip id: ydrip_sensor usage_alert_count: 1024 leak_alert_count: 32 low_freq_leak_thresh: 0.125 usage: name: \"Water Usage\" leak: name: \"Leak Detection\" battery_level: name: \"Battery Level\" usage_alert_count: Number of magnet rotations to wake up the ESP and report water usage. Should be a power of 2. leak_alert_count: Number of magnet rotations below low_freq_leak_thresh to wake up the ESP and report a leake. Should be a power of 2. low_freq_leak_thresh: Magnetic rotation frequency cutoff Hz. You should also change your fallback hotspot SSID and password. # Enable fallback hotspot (captive portal) in case wifi connection fails ap: ssid: \"Home Fallback Hotspot\" password: \"\"","title":"YAML Settings"},{"location":"v0.4/#flashing-new-releases","text":"To keep your YDrip device updated: Download the latest firmware from the YDrip GitHub releases page . Use the ESPHome Webtool or the Home Assistant ESPHome add-on to flash the firmware to your device. Enjoy using YDrip to monitor your water usage and conserve resources. If you encounter any issues, visit the GitHub Issues page for support.","title":"Flashing New Releases"}]}